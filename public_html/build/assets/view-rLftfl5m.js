let t=null;async function o(){let e=$("#objectId").val();if(e)try{let{data:s}=await ajax({url:`${API_BASEURL}/tickets/fetch/${e}`,type:"GET"});t=s}catch({error:s}){await Swal.fire(s.responseJSON.message,"","error"),location="/tickets"}}function r(){$("#code").html(t.code),$("#issue").html(t.issue),$("#response").html(t.response),$("#responder").html(t.responder===null?"":`${t.responder.first_name}  ${t.responder.last_name}`),$("#respondedAt").html(t.responded_at)}async function i(){swalLoading();try{let{data:e}=await ajax({url:`${API_BASEURL}/tickets/respond/${t.id}`,type:"POST",data:{response:$("#ourResponse").val()}});Toast.fire(e.message,"","success"),location.reload()}catch({error:e}){console.log(e),e.responseJSON.errors&&Swal.close(),showErrors(e.responseJSON,{response:"#ourResponse"})}}async function n(){try{if(!(await Swal.fire({title:`Voulez-vous vraiment supprimer l'assistance service ${t.code}?`,text:"Cette op√©ration est irreversible",icon:"question",showCancelButton:!0,confirmButtonText:"Oui",cancelButtonText:"Non"})).isConfirmed)throw{};swalLoading();let{data:s}=await ajax({url:`${API_BASEURL}/tickets/delete/${t.id}`,type:"POST"});Toast.fire(s.message,"","success"),location="/tickets"}catch({error:e}){Swal.fire(e.responseJSON.message,"","error")}}window.render=async function(){await o(),setTitle(`Details de l'assistance service ${t.code}`),r(),$("#edit").click(function(e){location=`/tickets/${t.id}/edit`}),$("#respond").click(function(e){$("#modalRespond").modal("show")}),$("#submitResponse").click(function(e){i()}),$("#delete").click(function(e){n()}),t.response!==null&&($("#edit").hide(),$("#respond").hide(),$("#delete").hide())};
