let t=null;async function n(){let e=$("#objectId").val();if(e)try{let{data:a}=await ajax({url:`${API_BASEURL}/inv-orders/fetch/${e}`,type:"GET"});t=a}catch({error:a}){await Swal.fire(a.responseJSON.message,"","error"),location="/inv-orders"}}function i(){$("#clientFirstName").val(""),$("#clientLastName").val(""),clearProductAdding(),$(".is-invalid").removeClass("is-invalid")}function r(){$("#clientFirstName").val(t.client_first_name),$("#clientLastName").val(t.client_last_name),setProductAdding(t.products)}async function s(){swalLoading();try{let{data:e}=await ajax({url:`${API_BASEURL}/inv-orders/store`,type:"POST",data:fillProductAdding({client_first_name:$("#clientFirstName").val(),client_last_name:$("#clientLastName").val()})});Toast.fire(e.message,"","success"),i()}catch({error:e}){console.log(e),e.responseJSON.errors&&Swal.close(),showErrors(e.responseJSON,{client_first_name:"#clientFirstName",client_last_name:"#clientLastName"})}}async function l(){swalLoading();try{let{data:e}=await ajax({url:`${API_BASEURL}/inv-orders/update/${t.id}`,type:"POST",data:fillProductAdding({client_first_name:$("#clientFirstName").val(),client_last_name:$("#clientLastName").val()})});Toast.fire(e.message,"","success"),location=`/inv-orders/${t.id}`}catch({error:e}){console.log(e),e.responseJSON.errors&&Swal.close(),showErrors(e.responseJSON,{client_first_name:"#clientFirstName",client_last_name:"#clientLastName"})}}window.render=async function(){await Promise.all([n(),populateProductAdding()]),initProductAdding(),setTitle(t?`Ã‰dition de la commande ${t.code}`:"Nouvelle commande"),t?r():i(),$("#form").submit(function(e){e.preventDefault(),t?l():s()})};
