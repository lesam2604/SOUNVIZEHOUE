window.API_BASEURL=$('meta[name="api_baseurl"]').attr("content");window.TOAST_DURATION=7e3;var w;const f=((w=document.querySelector('meta[name="csrf-token"]'))==null?void 0:w.content)||"";f&&$.ajaxSetup({headers:{"X-CSRF-TOKEN":f}});window.USER={set:function(e){for(const t in e)this[t]=e[t]},hasRole:function(...e){for(const t of e)if(this.roles.indexOf(t)!==-1)return!0;return!1},can:function(...e){for(const t of e)if(this.permissions.indexOf(t)!==-1)return!0;return!1},cannot:function(...e){return!this.can(...e)}};window.SETTINGS=null;window.isValidURL=function(e){try{const t=new URL(e);return t.protocol==="http:"||t.protocol==="https:"}catch{return!1}};window.Toast=Swal.mixin({toast:!0,position:"top",showConfirmButton:!1,timer:TOAST_DURATION,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}});window.toast=function(e="SZ",t=TOAST_DURATION,o="info",n="top-center",r=!0){const[a,i]=n.split("-"),l={info:"#435ebe",success:"#4fbe87",error:"#ef5350"}[o];Toastify({text:e,duration:t,close:r,gravity:a,position:i,style:{background:l}}).showToast()};window.toastInfo=function(e){toast(e,TOAST_DURATION,"info","top-center",!0)};window.toastSuccess=function(e){toast(e,TOAST_DURATION,"success","top-center",!0)};window.toastError=function(e){toast(e,TOAST_DURATION,"error","top-center",!0)};$.ajaxSetup({beforeSend:function(e,t){var a;const o=(t==null?void 0:t.url)||"";if(typeof API_BASEURL=="string"&&o.startsWith(API_BASEURL)){const i=localStorage.getItem("token")||"";i&&e.setRequestHeader("Authorization",`Bearer ${i}`)}const r=((a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.content)||"";r&&e.setRequestHeader("X-CSRF-TOKEN",r),e.setRequestHeader("X-Requested-With","XMLHttpRequest")}});window.hidePreloader=function(){$("#preloader-container").hide(),$("body").removeClass("loading")};window.ajax=function(e){return new Promise((t,o)=>{e.success=(n,r,a)=>{t({data:n,textStatus:r,jqXHR:a})},e.error=(n,r,a)=>{o({error:n,textStatus:r,errorThrown:a})},"dataType"in e||(e.dataType="json"),$.ajax(e)})};window.downloadFile=async function(e,t="GET",o={}){let{data:n,textStatus:r,jqXHR:a}=await ajax({url:e,type:t,data:o,dataType:null,xhr:function(){let s=new XMLHttpRequest;return s.onreadystatechange=function(){s.readyState==2&&(s.status==200?s.responseType="blob":s.responseType="text")},s}}),i="",l=a.getResponseHeader("Content-Disposition");if(l&&l.indexOf("attachment")!==-1){let c=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(l);c!=null&&c[1]&&(i=c[1].replace(/['"]/g,""))}let u=URL.createObjectURL(n),d=$(`<a href="${u}" download="${i}"></a>`).appendTo("body");d[0].click(),d.remove(),URL.revokeObjectURL(u)};window.getUser=async function(){try{let{data:e}=await ajax({url:`${API_BASEURL}/user`,type:"GET"});return e}catch({error:e}){throw new Error(e.responseJSON.message)}};window.getSettings=async function(){try{let{data:e}=await ajax({url:`${API_BASEURL}/settings`,type:"GET"});return e}catch({error:e}){throw new Error(e.responseJSON.message)}};window.logout=async function(){try{let{data:e}=await ajax({url:`${API_BASEURL}/logout`,type:"POST"});return e}catch({error:e}){throw new Error(e.responseJSON.message)}};window.getUploadUrl=function(e){return isValidURL(e)?e:API_BASEURL+"/public-files/uploads/"+e};window.getThumbnailUrl=function(e){return isValidURL(e)?e:API_BASEURL+"/public-files/thumbnails/"+e};window.getCountryFlagUrl=function(e,t=32,o=24){return`https://flagcdn.com/${t}x${o}/${e}.png`};window.swalLoading=function(){Swal.fire({title:"Traitement en cours...",allowOutsideClick:!1,didOpen:()=>{Swal.showLoading()}})};window.setCookie=function(e,t){document.cookie=`${e}=${t}; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/;`};window.deleteCookie=function(e){document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/;`};window.getTimeAgo=function(e){const t=moment(),o=moment(e),n=t.diff(o,"seconds"),r=t.diff(o,"minutes"),a=t.diff(o,"hours");return n<60?`Il y a ${n} seconde${n>1?"s":""}`:r<60?`Il y a ${r} minute${r>1?"s":""}`:a<24?`Il y a ${a} heure${a>1?"s":""}`:o.format("YYYY-MM-DD HH:mm:ss")};window.toCamelCase=function(e){return e.replace(/([-_][a-z])/g,t=>t.charAt(1).toUpperCase())};window.showErrors=function(e,t=null){if(e.errors){$(".is-invalid").removeClass("is-invalid");for(const o in e.errors){let n=t&&t[o]?t[o]:"#"+o;$(n).addClass("is-invalid").siblings(".invalid-feedback").text(e.errors[o][0])}}else e.message&&Swal.fire(e.message,"","error")};window.viewErrors=function(e){let t=[];for(const o in e)e[o].forEach(n=>t.push(n));Swal.fire({title:"Erreurs",html:t.join("<br>"),icon:"error"})};window.firstError=function(e){for(const t in e)return e[t][0]};window.setTitle=function(e){$("#title").html(e),document.title=`${e} | SOUNVI ZEHOUE`};window.formatAmount=function(e){return parseInt(e)+" FCFA"};window.formatAmountSpaced=function(e){return parseInt(e).toLocaleString("fr-FR")+" FCFA"};window.populatePartners=function(e,t=!1){const o=r=>r.id?$(`
      <div class="d-flex align-items-center position-relative mb-3">
        <div class="avatar avatar-2xl">
          <img class="rounded-circle" src="${getThumbnailUrl(r.picture)}" alt="">
        </div>
        <div class="flex-1 ms-3">
          <h6 class="mb-0 fw-semi-bold">${r.first_name} ${r.last_name} (${r.code})</h6>
          <p class="text-500 fs--2 mb-0">${r.company_name}</p>
        </div>
      </div>
    `):r.text,n=r=>r.id?$(`<span>${r.first_name} ${r.last_name} (${r.code})</span>`):r.text;$(e).each(function(){$(this).select2({data:[],theme:"bootstrap-5",placeholder:"Partenaire",allowClear:!0,templateResult:o,templateSelection:n,ajax:{url:`${API_BASEURL}/partners/fetch-by-term`,data:function(r){return{term:r.term,fixed_code:t}},processResults:function(r){return{results:r}}}})})};window.populateCompanies=function(e){const t=n=>n.id?$(`
      <div class="d-flex align-items-center position-relative mb-3">
        <div class="flex-1 ms-3">
          <h6 class="mb-0 fw-semi-bold">${n.name}</h6>
          <p class="text-500 fs--2 mb-0">${n.tin}</p>
        </div>
      </div>
    `):n.text,o=n=>n.id?$(`<span>${n.name} (${n.tin})</span>`):n.text;$(e).each(function(){$(this).select2({data:[],theme:"bootstrap-5",placeholder:"Nom d’établissement, numéro IFU",allowClear:!0,templateResult:t,templateSelection:o,ajax:{url:`${API_BASEURL}/partners/fetch-companies-by-term`,data:function(n){return{term:n.term}},processResults:function(n){return{results:n}}}})})};window.htmlEntities=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")};window.formatDate=function(e){return moment(e).format("YYYY-MM-DD")};window.formatDateTime=function(e){return moment(e).format("YYYY-MM-DD HH:mm:ss")};window.truncate=function(e,t=20){return e.length<=t?e:e.substring(0,t)+"..."};window.renderScrollingMessageHtml=function(e){const t={small:"h5",medium:"h3",large:"h1"},o={black:"black",blue:"blue",red:"red",yellow:"yellow",green:"green"};return $(`<${t[e.size]}/>`).addClass("moving-text text-nowrap").css("color",o[e.color]).css("animation-duration",`${e.time}s`).text(e.content)};window.getUbaTypes=async function(){try{let{data:e}=await ajax({url:`${API_BASEURL}/operations/uba-types`,type:"GET"});return e}catch({error:e}){throw new Error(e.responseJSON.message)}};window.getResource=async function(e,t="GET",o={}){try{let{data:n}=await ajax({url:e,type:t,data:o});return[n,null]}catch({error:n}){return console.log(n),[null,n]}};window.ubaTypes=null;window.extraClients=null;window.populateUbaTypes=async function(e,t=null,o=""){window.ubaTypes===null&&(window.ubaTypes=await getUbaTypes()),$(e).each(function(){$(this).html('<option value=""></option>');for(const n of window.ubaTypes)$(this).append(`<option value="${n}">${n}</option>`);$(this).select2({placeholder:"Toutes les catégories de cartes",allowClear:!0,theme:"bootstrap-5",dropdownParent:t}).val(o).change()})};window.populateExtraClients=async function(e,t=null,o=""){window.extraClients===null&&(window.extraClients=(await getResource(`${API_BASEURL}/extra-clients/fetch-all`))[0]),$(e).each(function(){$(this).html('<option value=""></option>');for(const n of window.extraClients)$(this).append(`
        <option value="${n.id}">
          ${n.first_name} ${n.last_name} (${n.company_name} - ${n.tin})
        </option>
      `);$(this).select2({placeholder:"Sélectionnez un client extra",allowClear:!0,theme:"bootstrap-5",dropdownParent:t}).val(o).change()})};window.hasCommissions=function(e,t,o){return o||(o=null),e.operation_types.find(n=>n.operation_type_id===t&&n.card_type===o&&n.has_commissions)};window.cardTypes=null;window.getCardTypes=async function(){try{let{data:e}=await ajax({url:`${API_BASEURL}/card-types/fetch-all`,type:"GET"});return e}catch({error:e}){throw new Error(e.responseJSON.message)}};window.populateCardTypes=async function(e,t=null,o=""){window.cardTypes===null&&(window.cardTypes=await getCardTypes()),$(e).each(function(){$(this).html('<option value=""></option>');for(const n of window.cardTypes)$(this).append(`<option value="${n}">${n}</option>`);$(this).select2({placeholder:"Sélectionnez un type de carte",allowClear:!0,theme:"bootstrap-5",dropdownParent:t}).val(o).change()})};
