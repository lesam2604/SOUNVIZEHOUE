let s=null;async function i(){let e=$("#objectId").val();if(e)try{let{data:t}=await ajax({url:`${API_BASEURL}/tickets/fetch/${e}`,type:"GET"});s=t}catch({error:t}){await Swal.fire(t.responseJSON.message,"","error"),location="/tickets"}}function a(){$("#issue").val(""),$(".is-invalid").removeClass("is-invalid")}function o(){$("#issue").val(s.issue)}async function r(){swalLoading();try{let{data:e}=await ajax({url:`${API_BASEURL}/tickets/store`,type:"POST",data:{issue:$("#issue").val()}});Toast.fire(e.message,"","success"),a()}catch({error:e}){console.log(e),e.responseJSON.errors&&Swal.close(),showErrors(e.responseJSON)}}async function c(){swalLoading();try{let{data:e}=await ajax({url:`${API_BASEURL}/tickets/update/${s.id}`,type:"POST",data:{issue:$("#issue").val()}});Toast.fire(e.message,"","success"),location=`/tickets/${s.id}`}catch({error:e}){console.log(e),e.responseJSON.errors&&Swal.close(),showErrors(e.responseJSON)}}window.render=async function(){await i(),setTitle(s?`Ã‰dition de l'assistance service ${s.code}`:"Nouvelle assistance service"),s?o():a(),$("#form").submit(function(e){e.preventDefault(),s?c():r()})};
