let t=null;async function n(){let e=$("#objectId").val();if(e)try{let{data:a}=await ajax({url:`${API_BASEURL}/card-categories/fetch/${e}`,type:"GET"});t=a}catch({error:a}){await Swal.fire(a.responseJSON.message,"","error"),location="/card-categories"}}function i(){$("#name").val(""),$("#unitPrice").val(""),$("#stockQuantityMin").val(""),$("#picture").val(""),$(".update-image-helper").hide(),$(".is-invalid").removeClass("is-invalid")}function r(){$("#name").val(t.name),$("#unitPrice").val(t.unit_price),$("#stockQuantityMin").val(t.stock_quantity_min),$("#picture").val("")}async function c(){swalLoading();let e=new FormData;e.append("name",$("#name").val()),e.append("unit_price",$("#unitPrice").val()),e.append("stock_quantity_min",$("#stockQuantityMin").val()),e.append("picture",$("#picture")[0].files[0]??"");try{let{data:a}=await ajax({url:`${API_BASEURL}/card-categories/store`,type:"POST",contentType:!1,processData:!1,data:e});Toast.fire(a.message,"","success"),i()}catch({error:a}){console.log(a),a.responseJSON.errors&&Swal.close(),showErrors(a.responseJSON,{name:"#name",unit_price:"#unitPrice",stock_quantity_min:"#stockQuantityMin",picture:"#picture"})}}async function o(){swalLoading();let e=new FormData;e.append("name",$("#name").val()),e.append("unit_price",$("#unitPrice").val()),e.append("stock_quantity_min",$("#stockQuantityMin").val()),e.append("picture",$("#picture")[0].files[0]??"");try{let{data:a}=await ajax({url:`${API_BASEURL}/card-categories/update/${t.id}`,type:"POST",contentType:!1,processData:!1,data:e});Toast.fire(a.message,"","success"),location=`/card-categories/${t.id}`}catch({error:a}){console.log(a),a.responseJSON.errors&&Swal.close(),showErrors(a.responseJSON,{name:"#name",unit_price:"#unitPrice",stock_quantity_min:"#stockQuantityMin",picture:"#picture"})}}window.render=async function(){await n(),setTitle(t?`Édition de la catégorie de carte ${t.code}`:"Nouvelle catégorie de carte"),t?r():i(),$("#form").submit(function(e){e.preventDefault(),t?o():c()})};
