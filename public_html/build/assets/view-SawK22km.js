let e=null;async function i(){let t=$("#objectId").val();if(t)try{let{data:a}=await ajax({url:`${API_BASEURL}/collabs/fetch/${t}`,type:"GET"});e=a}catch({error:a}){await Swal.fire(a.responseJSON.message,"","error"),location="/collabs"}}function o(){$("#code").html(e.code),$("#firstName").html(e.first_name),$("#lastName").html(e.last_name),$("#phoneNumber").html(e.phone_number),$("#email").html(e.email),$("#picture").html(`<img src="${getUploadUrl(e.picture)}" width="360">`),$("#status").html(e.status==="enabled"?'<span class="badge rounded-pill bg-success">Actif</span>':'<span class="badge rounded-pill bg-secondary">Inactif</span>')}async function l(t){try{if(!(await Swal.fire({title:`Voulez-vous vraiment ${t==="enabled"?"activer":"désactiver"} le collaborateur ${e.code}?`,text:"Cette opération est irréversible",icon:"question",showCancelButton:!0,confirmButtonText:"Oui",cancelButtonText:"Non"})).isConfirmed)throw{};swalLoading();let{data:s}=await ajax({url:`${API_BASEURL}/collabs/change-status/${e.id}`,type:"POST",data:{status:t}});Toast.fire(s.message,"","success"),location.reload()}catch({error:a}){Swal.fire(a.responseJSON.message,"","error")}}async function n(){try{if(!(await Swal.fire({title:`Voulez-vous vraiment supprimer le collaborateur ${e.code}?`,text:"Cette opération est irreversible",icon:"question",showCancelButton:!0,confirmButtonText:"Oui",cancelButtonText:"Non"})).isConfirmed)throw{};swalLoading();let{data:a}=await ajax({url:`${API_BASEURL}/collabs/delete/${e.id}`,type:"POST"});Toast.fire(a.message,"","success"),location="/collabs"}catch({error:t}){Swal.fire(t.responseJSON.message,"","error")}}window.render=async function(){await i(),setTitle(`Details du collaborateur ${e.code}(${e.first_name} ${e.last_name})`),o(),$("#enable").click(async function(t){await l("enabled")}),$("#disable").click(async function(t){await l("disabled")}),$("#delete").click(async function(t){await n()}),e.status!=="disabled"&&$("#enable").hide(),e.status!=="enabled"&&$("#disable").hide()};
