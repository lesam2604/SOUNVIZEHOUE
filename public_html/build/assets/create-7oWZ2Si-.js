let e=null;async function r(){let a=$("#objectId").val();if(a)try{let{data:t}=await ajax({url:`${API_BASEURL}/extra-clients/fetch/${a}`,type:"GET"});e=t}catch({error:t}){await Swal.fire(t.responseJSON.message,"","error"),location="/extra-clients"}}function n(){$("#companyName").val(""),$("#tin").val(""),$("#phoneNumber").val(""),$("#firstName").val(""),$("#lastName").val(""),$(".is-invalid").removeClass("is-invalid")}function s(){$("#companyName").val(e.company_name),$("#tin").val(e.tin),$("#phoneNumber").val(e.phone_number),$("#firstName").val(e.first_name),$("#lastName").val(e.last_name)}async function o(){swalLoading();try{let{data:a}=await ajax({url:`${API_BASEURL}/extra-clients/store`,type:"POST",data:{company_name:$("#companyName").val(),tin:$("#tin").val(),phone_number:$("#phoneNumber").val(),first_name:$("#firstName").val(),last_name:$("#lastName").val()}});Toast.fire(a.message,"","success"),n()}catch({error:a}){console.log(a),a.responseJSON.errors&&Swal.close(),showErrors(a.responseJSON,{company_name:"#companyName",tin:"#tin",phone_number:"#phoneNumber",first_name:"#firstName",last_name:"#lastName"})}}async function l(){swalLoading();try{let{data:a}=await ajax({url:`${API_BASEURL}/extra-clients/update/${e.id}`,type:"POST",data:{company_name:$("#companyName").val(),tin:$("#tin").val(),phone_number:$("#phoneNumber").val(),first_name:$("#firstName").val(),last_name:$("#lastName").val()}});Toast.fire(a.message,"","success"),location=`/extra-clients/${e.id}`}catch({error:a}){console.log(a),a.responseJSON.errors&&Swal.close(),showErrors(a.responseJSON,{company_name:"#companyName",tin:"#tin",phone_number:"#phoneNumber",first_name:"#firstName",last_name:"#lastName"})}}window.render=async function(){await r(),setTitle(e?`Ã‰dition du client extra ${e.code}`:"Nouveau client extra"),e?s():n(),$("#form").submit(function(a){a.preventDefault(),e?l():o()})};
